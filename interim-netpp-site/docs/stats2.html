<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>stats2 – CoastWatch Primary Productivity Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/NOAA_logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">CoastWatch Primary Productivity Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./algorithm.html"> 
<span class="menu-text">Algorithm and Data</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./stats2.html" aria-current="page"> 
<span class="menu-text">Statistical Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./user_resources.html"> 
<span class="menu-text">User Resources</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#summary-of-results" id="toc-summary-of-results" class="nav-link active" data-scroll-target="#summary-of-results">Summary of Results</a></li>
  <li><a href="#psi" id="toc-psi" class="nav-link" data-scroll-target="#psi">Unbiased Relative Difference (ψ)</a>
  <ul>
  <li><a href="#temporal-variability" id="toc-temporal-variability" class="nav-link" data-scroll-target="#temporal-variability">Temporal Variability</a></li>
  <li><a href="#spatial-variability" id="toc-spatial-variability" class="nav-link" data-scroll-target="#spatial-variability">Spatial Variability</a></li>
  </ul></li>
  <li><a href="#trends-analysis" id="toc-trends-analysis" class="nav-link" data-scroll-target="#trends-analysis">Trends Analysis</a>
  <ul>
  <li><a href="#contingency-matrices-and-cohens-kappa" id="toc-contingency-matrices-and-cohens-kappa" class="nav-link" data-scroll-target="#contingency-matrices-and-cohens-kappa">Contingency Matrices and Cohen’s Kappa</a></li>
  </ul></li>
  <li><a href="#download-statistical-analysis-data-products" id="toc-download-statistical-analysis-data-products" class="nav-link" data-scroll-target="#download-statistical-analysis-data-products">Download Statistical Analysis Data Products</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a>
  <ul>
  <li><a href="#psi_appendix" id="toc-psi_appendix" class="nav-link" data-scroll-target="#psi_appendix">Unbiased Relative Difference (ψ)</a></li>
  <li><a href="#trends_appendix" id="toc-trends_appendix" class="nav-link" data-scroll-target="#trends_appendix">Trends Analysis</a></li>
  <li><a href="#tables_appendix" id="toc-tables_appendix" class="nav-link" data-scroll-target="#tables_appendix">Contingency Matrix and Cohen’s Kappa</a>
  <ul class="collapse">
  <li><a href="#cohens-kappa-measuring-agreement-beyond-chance" id="toc-cohens-kappa-measuring-agreement-beyond-chance" class="nav-link" data-scroll-target="#cohens-kappa-measuring-agreement-beyond-chance">Cohen’s Kappa: Measuring Agreement Beyond Chance</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<h1>
Statistical Analysis
</h1>
<p>To evaluate how the interim primary productivity products (<strong>VIIRS-SNPP</strong> and <strong>VIIRS-NOAA-20</strong>) differ from the legacy product (<strong>MODIS-Aqua</strong>), we conducted a comprehensive statistical analysis that includes the following methods:</p>
<ul>
<li>Calculating the <a href="#psi">Unbiased Relative Difference (ψ)</a>, which is a measure of how similar the interim and legacy products netPP values are.</li>
<li>Comparing <a href="#trends-analysis">long-term trends</a> in netPP, which evaluates if the two products track the same trends, or lack of trends, in the data over time.</li>
</ul>
<p>For the VIIRS SNPP analysis we used a 10-year time period from January 2013 to December 2023. For the VIIRS NOAA-20 analysis we used a 5-year time period from January 2018 to December 2023.</p>
<section id="summary-of-results" class="level2">
<h2 data-anchor-id="summary-of-results">Summary of Results</h2>
<ul>
<li><p>VIIRS SNPP and VIIRS NOAA-20 interim primary productivity products both have similar values as the legacy product. Multi-year analysis showed that the mean monthly difference between either interim product and the legacy product was no more that 7%. Spatially, differences between the interim and legacy products were typically less than 5% in open ocean regions, 5-10% in subtropical gyres, and greater than 20% at high latitudes and coastal upwelling zones.</p></li>
<li><p>Interim SNPP and NOAA-20 produce trend patterns that are consistent with the legacy product. Visually, the global trend maps display negative trends in subtropical gyres and major current systems, and positive trends in high latitude and coastal upwelling regions. Contingency analysis further supports the similarity in trend patterns, showing 86% agreement between SNPP and the legacy product, and over 88% agreement between NOAA-20 and the legacy product. Cohen’s Kappa values of 0.86 (SNPP) and 0.89 (NOAA-20) indicate almost perfect agreement in slope trend direction between the interim and legacy netPP products.</p></li>
</ul>
<p>The relatively small differences between the interim products and the legacy product suggests that either interim would be a suitable replacement for the legacy product in many applications.</p>
</section>
<section id="psi" class="level2">
<h2 data-anchor-id="psi">Unbiased Relative Difference (ψ)</h2>
<p>In plain language, Unbiased Relative Difference (ψ) is the difference between interim and legacy primary productivity values (netPP), normalized to the mean of the two values. Normalizing to the mean avoids the bias of arbitrarily selecting one product as the reference. For a detailed explanation of the calculation, see the <a href="#psi_appendix">Appendix</a>. This analysis allows us to determine how similar netPP values are between the interim and legacy products.</p>
<p>For our analysis, we calculated ψ for each pixel in our global grid for each month over a multi-year timespan. The resulting monthly maps of global ψ allowed us to generate a timeseries of mean global monthly ψ and a map of the multi-year mean ψ for each pixel in our global grid.</p>
<div style="text-align: center;">
<p><a href="images/psi_diagram.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/psi_diagram.png" class="img-fluid" style="width:100.0%"></a></p>
<p><span style="font-size: 0.95em; color: #444; display: block; margin-top: 0.5em;"> <strong>Figure 1.</strong> Conceptual workflow for calculating unbiased relative difference (ψ) between interim and legacy satellite-derived net primary productivity (netPP) products. The yellow layers represent monthly netPP data from the Interim and Legacy datasets. Matching pixels are connected by the red lines. Monthly ψ maps are calculated for each time step, forming the blue layers. A time series of ψ is extracted from the blue stack, and a multi-year average is computed (green layer). </span></p>
</div>
<section id="temporal-variability" class="level3">
<h3 data-anchor-id="temporal-variability">Temporal Variability</h3>
<p>For the VIIRS SNPP interim product relative to the legacy product, monthly mean global ψ values are positive over most of the 10-year timeseries, indicating that the interim netPP values are on average greater than the legacy values. The values for the interim product were quite similar to the legacy values, as indicated by ψ values ranging from 0 to 0.07 (0-7% difference from the legacy product) over the entire timeseries.</p>
<p>For the VIIRS NOAA-20 interim product, monthly mean global ψ values were also positive over most of the 5-year timeseries and within a range of 0 to 0.07 (0-7% difference from the legacy product). These values were slightly lower than those observed for SNPP over its respective time period, but similarly indicate that the interim netPP estimates were generally higher than those from the legacy product.</p>
<div style="text-align: center;">
<p><span style="font-size: 1.5em; font-weight: bold;">Timeseries: Monthly Means of Unbiased Relative Difference</span></p>
<p><span style="font-size: 0.95em; color: #444; display: block; margin-top: 0.5em;"> <a href="images/greyscale_psi_timeseries.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="images/greyscale_psi_timeseries.png" class="img-fluid" style="max-width: 1600px;;width:100.0%"></a> <strong>Figure 2.</strong> The timeseries of mean global ψ values for each month from January 2013 to December 2022 (a ten-year period). </span></p>
</div>
</section>
<section id="spatial-variability" class="level3">
<h3 data-anchor-id="spatial-variability">Spatial Variability</h3>
<p>The 10-year average map (<strong>Figure 3a</strong>) reveals the spatial variable in ψ, with most oceanic regions showing &lt;5% difference (lightest blue and pink) between the two netPP products. However, in the tropical and subtropical gyres there is a 5-10% difference between SNPP and the legacy product (medium blue) and areas of higher differences (&gt;20%) are visible at high latitudes and in coast upwelling regions.</p>
<p>The 5-year average map (<strong>Figure 3b</strong>) shows similar spatial patterns in ψ that are consistent with those observed for SNPP. Most open ocean regions show &lt;5% difference between NOAA-20 and legacy netPP products. Moderate differences (5-10%) are apparent in the subtropical gyres and larger differences (&gt;20%) are observed at higher latitudes in both hemispheres and along coastal upwelling regions. Compared to SNPP, the NOAA-20 map contains slightly larger areas of difference.</p>
<div style="text-align: center;">
<p><span style="font-size: 1.5em; font-weight: bold;">Unbiased Relative Difference</span></p>
<p><span style="font-size: 0.95em; color: #444; display: block; margin-top: 0.5em;"> <a href="images/new_psi_comparison.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="images/new_psi_comparison.png" class="img-fluid" style="width:100.0%"></a> <strong>Figure 3.</strong> Global maps of the multi-year mean unbiased relative difference (ψ) comparing VIIRS-SNPP(<strong>a</strong>) and VIIRS-NOAA(<strong>b</strong>) with MODIS-Aqua. Positive (blue) values indicate that the interim product netPP values are larger than those of the legacy product and negative (red) values indicate that the interim product netPP values are less than those of the legacy product. </span></p>
</div>
</section>
</section>
<section id="trends-analysis" class="level2">
<h2 data-anchor-id="trends-analysis">Trends Analysis</h2>
<p>Temporal trends were calculated globally for the interim and legacy primary productivity products using linear regression methods. For our analysis, we determined the slopes of netPP versus time for each pixel in our global grid over a multi-year timespan using monthly netPP data. Results for the interim and legacy products were compared to identify how well the two products agree on the presence or absence of long-term trends. The purpose of this analysis was to identify how well the interim and legacy primary productivity timeseries agree using an arbitrarily chosen trend analysis method, not to accurately identify environmentally relevant trends in the ocean. We also applied statistical methods <a href="#contingency-matrices-and-cohens-kappa">Contingency Matrices and Cohen’s Kappa</a> to evaluate the strength of agreement. For a detailed explanation of the calculations, see the <a href="#trends_appendix">Appendix</a>.</p>
<div style="text-align: center;">
<p><a href="images/trends_diagram.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="images/trends_diagram.png" class="img-fluid" style="width:100.0%"></a></p>
<p><span style="font-size: 0.95em; color: #444; display: block; margin-top: 0.5em;"> <strong>Figure 4.</strong> Conceptual workflow illustrating how trends in netPP are calculated using linear regression. Monthly netPP maps from January 2013 to December 2022 (yellow layers) are used to estimate the slope (β) at each pixel across time. The slope values are compiled into a spatial map (blue layer) representing trend in productivity over the timeseries. </span></p>
</div>
<p>Visually, the global maps of slopes show very similar trend patterns, indicating that the interim and legacy products yield similar trends (<strong>Figure 5</strong>). The SNPP (<strong>a</strong>) and legacy (<strong>b</strong>) maps both show negative trends (red) in subtropical gyres and major current systems, and positive trends (blue) are shown in higher latitudes and coastal upwelling zones. Relative to the legacy product, the SNPP map displays more positive trends in coastal regions.</p>
<p>The NOAA-20 (<strong>c</strong>) and legacy (<strong>d</strong>) maps also show similar large-scale patterns, with negative trends across much of the subtropical gyres and open ocean, and positive trends concentrated in polar and coastal upwelling regions. Compared to the legacy product, the NOAA-20 map exhibits slightly stronger trend magnitudes, particularly in the coastal and high-latitude zones.</p>
<div style="text-align: center;">
<p><span style="font-size: 1.5em; font-weight: bold;">Multi-Year Trend Maps</span></p>
<p><a href="images/trends_with_centered_colorbar.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="images/trends_with_centered_colorbar.png" class="img-fluid" style="width:100.0%"></a></p>
<p><span style="font-size: 0.95em; color: #444; display: block; margin-top: 0.5em;"> <strong>Figure 5.</strong> Linear trends in monthly primary productivity from (<strong>a</strong>) interim VIIRS SNPP and (<strong>b</strong>) legacy products for the years 2013-2022. Linear trends in monthly primary productivity from (<strong>c</strong>) interim VIIRS NOAA-20 and (<strong>d</strong>) legacy products for the years 2018-2022. Positive values (blue) indicate increasing trends in netPP, while negative values (red) indicate decreasing trends. </span></p>
</div>
<section id="contingency-matrices-and-cohens-kappa" class="level3">
<h3 data-anchor-id="contingency-matrices-and-cohens-kappa">Contingency Matrices and Cohen’s Kappa</h3>
<p>To obtain more quantitative results from the trends analysis, we built contingency matrices using the slope data. Contingency analysis is an approach used to test whether or not there is an association between categorical variables. We treated the slopes from the trend analysis as categorical variables by recording whether the slope had a statistically significant positive value (β &gt; 0), a statistically negative value (β &lt; 0), or if the slope was not significantly different from zero (n.s.). This categorization was done for each pixel in the global maps of slopes for both the interim and legacy products. Therefore, for each pixel location there were nine possible slope combinations (<strong>Figure 6</strong>). The cells on the downward-sloping diagonal (from left to right) are the combinations where the interim and legacy products agree.</p>
<div style="text-align: center;">
<p><a href="images/contingency_diagrams.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="images/contingency_diagrams.png" class="img-fluid" width="500"></a></p>
<p><span style="font-size: 0.95em; color: #444; display: block; margin-top: 0.5em;"> <strong>Figure 6.</strong> Contingency matrix of all possible combinations of pixel location trends and significance outcomes between the interim and legacy netPP products. Each cell describes one of nine possible category pairings based on whether a pixel exhibited no significant trends (n.s.), a significant positive trend (β &gt; 0), or a significant negative trend (β &lt; 0) in each dataset. Columns represent trend categories from the legacy product; rows represent trend categories from the interim product. </span></p>
</div>
<p>For our analysis comparing the interim product to the legacy product, the percent of the total pixels that fell into each of the nine combinations was tallied and placed in the corresponding cell in the matrix. Tallying the values on the downward-sloping diagonal yielded the percentage of pixels where the slope trends were in agreement. In addition, we use Cohen’s Kappa as a statistical measure to quantify reliability of the agreement between the two products, accounting for the possibility that they could agree by chance. Cohen’s Kappa values range from &lt; 0 (no agreement) to 1 (perfect agreement); Cohen’s Kappa was interpreted using a standard scale <a href="#references">Viera and Garrett 2005</a>. Qualitative categories for Cohen’s Kappa values are listed in <strong>Table 1</strong>.</p>
<div style="text-align: center;">
<p><span style="font-size: 0.95em; color: #444; display: block; margin-top: 0.5em;"> <strong>Table 1.</strong> Scale for Cohen’s Kappa coefficient values, indicating the level of agreement between two categorical classifications. The scale ranges from &lt; 0 (no agreement) to 1.00 (perfect agreement), with descriptive categories assigned to each interval. </span> <a href="images/cohens_kappa.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="images/cohens_kappa.png" class="img-fluid" width="500"></a></p>
</div>
<p>Tallying the values on the downward-sloping diagonal contingency matrix yield that co-occurrence slope trends shows 86% agreement between the SNPP interim and legacy products (<strong>Figure 7a</strong>) and over 88% agreement between the NOAA-20 interim and legacy products (<strong>Figure 7b</strong>). The Cohen’s Kappa values of 0.86 for the SNPP interim to legacy comparison and 0.89 for the NOAA-20 interim to legacy comparison, translated qualitatively to almost perfect agreement.</p>
<div style="text-align: center;">
<p><span style="font-size: 1.5em; font-weight: bold;">Contingency Matrices for Interim and Legacy Products</span> <a href="images/contingency_tables.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="images/contingency_tables.png" class="img-fluid" style="width:100.0%"></a></p>
<p><span style="font-size: 0.95em; color: #444; display: block; margin-top: 0.5em;"> <strong>Figure 7.</strong> Contingency table and Cohen’s Kappa statistic comparing (<strong>a</strong>) the VIIRS SNPP and the legacy products and (<strong>b</strong>) the VIIRS NOAA-20 and the legacy products. </span></p>
</div>
</section>
</section>
<section id="download-statistical-analysis-data-products" class="level2">
<h2 data-anchor-id="download-statistical-analysis-data-products">Download Statistical Analysis Data Products</h2>
<p>Access datasets used in the statistical analysis, including unbiased and biased relative differences, correlations, trends, and contingency matrices.</p>
<ul>
<li>
<a>Unbiased Relative Difference (ψ)</a>
</li>
<ul>
<li>
<a href="https://coastwatch.pfeg.noaa.gov/wcn/erddap/griddap/netpp_psi_snpp_modis.graph">VIIRS-SNPP - MODIS-Aqua</a>
</li>
<li>
<a href="https://coastwatch.pfeg.noaa.gov/wcn/erddap/griddap/netpp_psi_noaa20_modis.graph">VIIRS-NOAA-20 - MODIS-Aqua</a>
</li>
</ul>
<li>
<a>Linear Regression Trends</a>
</li>
<ul>
<li>
<a href="https://coastwatch.pfeg.noaa.gov/wcn/erddap/griddap/netpp_trends_viirssnpp_and_modisaqua.graph">MODIS-Aqua &amp; VIIRS SNPP</a>
</li>
<li>
<a href="https://coastwatch.pfeg.noaa.gov/wcn/erddap/griddap/netpp_trends_viirsnoaa20_and_modisaqua.graph">MODIS-Aqua &amp; VIIRS NOAA-20</a>
</li>
</ul>
</ul>
</section>
<section id="references" class="level2">
<h2 data-anchor-id="references">References</h2>
<p>
<a href="https://www.sciencedirect.com/science/article/pii/S0034425717301426">Mélin, F., V. Vantrepotte, A. Chuprin, M. Grant, T. Jackson, and S. Sathyendranath. 2017. Assessing the fitness-for-purpose of satellite multi-mission ocean color climate data records: A protocol applied to OC-CCI chlorophyll- a data. Remote Sensing of Environment 203:139–151. </a>

</p>
<p>
<a href="https://pubmed.ncbi.nlm.nih.gov/15883903/"> Viera, A. J., and J. M. Garrett. 2005. Understanding interobserver agreement: the kappa statistic. Family Medicine 37(5):360–363. </a>

</p>
</section>
<section id="appendix" class="level2">
<h2 data-anchor-id="appendix">Appendix</h2>
<p>The following sections provide detailed explanations of how the statistical analyses between the legacy and interim products were calculated. If you are interested in exploring or replicating these analyses yoursel, check out our <a href="./user_resources.html">Code Gallery</a> for step-by-step tutorials.</p>
<section id="psi_appendix" class="level3">
<h3 data-anchor-id="psi_appendix">Unbiased Relative Difference (ψ)</h3>
<p>The pixel-by-pixel <strong>unbiased relative difference (ψ<sup>netPP</sup>)</strong> was computed for the globe for each month at 9km resolution across <a href="#download-statistical-analysis-data-products">two datasets.</a></p>
<p>The unbiased relative difference (ψ<sup>netPP</sup>) is calculated for each pixel as follows:</p>
<blockquote class="blockquote">
<p style="text-align: left; color: black;  font-size: 1.5em;">
<span class="math inline">\(ψ^{netPP} = \frac{netPP_{VIIRS} - netPP_{MODIS}}{\left(\frac{netPP_{VIIRS} + netPP_{MODIS}}{2}\right)}\)</span>
</p>
</blockquote>
<p>
Where:
</p>
<ul>
<li>
The difference between VIIRS-based netPP (<i>netPP<sub>VIIRS</sub></i>) and MODIS-based netPP (<i>netPP<sub>MODIS</sub></i>) values for that pixel is divided by the mean of <i>netPP<sub>VIIRS</sub></i> and <i>netPP<sub>MODIS</sub></i>.
</li>
</ul>
<p>This metric allows for sensor-to-sensor consistency assessment, ensuring that variations are not biased by absolute magnitude differences.</p>
</section>
<section id="trends_appendix" class="level3">
<h3 data-anchor-id="trends_appendix">Trends Analysis</h3>
<p>The purpose of calculating <strong>linear regression trends</strong> for each of the products is to evaluate how much the products agree in temporal patterns. Linear trends were calculated in the time series of monthly primary productivity for every pixel with anomalies for the <a href="#download-statistical-analysis-data-products">MODIS-Aqua, VIIRS-SNPP, and VIIRS-NOAA-20 datasets</a>. Calculating trends with anomalies enables us to focus on trends by removing seasonality. P-values were calculated to test the statistical significance of the trends for each pixel.</p>
<p>The trend analysis follows methods outlined in <a href="#references">Melin et al.&nbsp;2017</a>, see the section 2.3 “Trend estimates and comparison of trends”.</p>
</section>
<section id="tables_appendix" class="level3">
<h3 data-anchor-id="tables_appendix">Contingency Matrix and Cohen’s Kappa</h3>
<p>To quantitatively assess agreement in trend classifications between the legacy and the interim netPP products, we use a <strong>contingency matrix</strong> and compute <strong>Cohen’s Kappa</strong>.</p>
<p>A contingency matrix compares the <strong>direction of linear trends</strong> between the legacy and interim netPP products at each pixel. Each trend is classified into one of three categories:</p>
<ul>
<li><strong>Positive trend</strong>: statistically significant increasing trend<br>
</li>
<li><strong>Negative trend</strong>: statistically significant decreasing trend<br>
</li>
<li><strong>No significant trend</strong>: slope not significantly different from zero (e.g., <em>p</em> &gt; 0.05)</li>
</ul>
<p>We then count how often each combination occurs across all pixels to build a 3×3 matrix:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>VIIRS Positive</th>
<th>VIIRS Negative</th>
<th>VIIRS No Trend</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>MODIS Positive</strong></td>
<td>a</td>
<td>b</td>
<td>c</td>
</tr>
<tr class="even">
<td><strong>MODIS Negative</strong></td>
<td>d</td>
<td>e</td>
<td>f</td>
</tr>
<tr class="odd">
<td><strong>MODIS No Trend</strong></td>
<td>g</td>
<td>h</td>
<td>i</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Diagonal cells</strong> (a, e, i) indicate agreement.</li>
<li><strong>Off-diagonal cells</strong> indicate disagreement.</li>
</ul>
<hr>
<section id="cohens-kappa-measuring-agreement-beyond-chance" class="level4">
<h4 data-anchor-id="cohens-kappa-measuring-agreement-beyond-chance">Cohen’s Kappa: Measuring Agreement Beyond Chance</h4>
<p><strong>Cohen’s Kappa (κ)</strong> quantifies how much the agreement between the legacy and interim products exceeds what would be expected by chance. It ranges from:</p>
<ul>
<li><strong>1</strong> = perfect agreement<br>
</li>
<li><strong>&lt;0</strong> = no better than random</li>
</ul>
<blockquote class="blockquote">
<p style="text-align: left; color: black; font-size: 1.5em;">
<span class="math inline">\(\kappa = \frac{P_o - P_e}{1 - P_e}\)</span>
</p>
</blockquote>
<p>Where:</p>
<ul>
<li><strong>( P_o )</strong> = observed agreement (proportion of pixels where legacy and interim agree):</li>
</ul>
<p><span class="math display">\[
P_o = \frac{a + e + i}{N}
\]</span></p>
<ul>
<li><strong>( P_e )</strong> = expected agreement by chance:</li>
</ul>
<p><span class="math display">\[
P_e = \frac{(a + b + c)(a + d + g) + (d + e + f)(b + e + h) + (g + h + i)(c + f + i)}{N^2}
\]</span></p>
<ul>
<li><strong>( N )</strong> = total number of valid pixels (sum of all cells):</li>
</ul>
<p><span class="math display">\[
N = a + b + c + d + e + f + g + h + i
\]</span></p>


</section>
</section>
</section>

</main> <!-- /main -->
<div style="text-align: center; padding: 20px; border-top: 1px solid #ddd;">
    <img src="images/DeptCommerce.png" alt="Logo 1" style="height: 70px; margin-right: 20px;">
    <img src="images/CoastWatchLogo.png" alt="Logo 2" style="height: 70px;">
</div>

<p style="text-align: right; font-size: 14px; margin-top: 10px;">
  <em>Created 2025-01-01 | Last modified 2025-04-10</em>
</p>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","openEffect":"zoom","descPosition":"bottom","selector":".lightbox","loop":false});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>