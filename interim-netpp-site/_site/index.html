<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CoastWatch Primary Productivity Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/NOAA_logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">CoastWatch Primary Productivity Project</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="developing-an-interim-primary-productivity-product" class="level1">
<h1>Developing an Interim Primary Productivity Product</h1>
<div class="figure">
<p><img src="images/productivity.png" class="img-fluid quarto-figure quarto-figure-center"> <span style="text-align: right; display: block;">Primary Productivity</span></p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">NetPP Product</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Algorithm and Data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Statistical Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">User Resources</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<h1>
Why do we need an interim product?
</h1>
<p>
The only available primary productivity satellite product from NOAA was developed by the CoastWatch West Coast Node in 2007. The product is based on the Vertically Generalized Production Model (VPGM) described by Behrenfeld and Falkowski (1997) utilizing data from the MODIS sensor on the Aqua satellite.
</p>
<p>
However, the MODIS Aqua sensor will be decommissioned soon. While new primary productivity algorithms that use the latest satellite sensors are under development, they are unlikely to be in production before MODIS Aqua is retired. Therefore, an interim product is required to address the needs of users for primary productivity data during the gap between the loss of the legacy MODIS primary productivity and the availablity of the new generation primary productivity products.
</p>
<p>
Two interim primary productivity products, VIIRS SNPP and VIIRS NOAA20, are now available. Details on how these products were developed, can be found under the <strong>Algorithm and Data</strong> tab.
</p>
<p>
</p>
<p>
Both interim products have undergone comprehensive statistical evaluation to ensure accuracy and reliability. The methods that were used to do so are found under the <strong>Statistical Analysis</strong> tab.
</p>
<p>
</p>
<p>
For users interested in conducting their own statistical analyses tailored to their region of interest will find Python notebooks in the <strong>User Resources</strong> tab that provide step-by-step guidance.
</p>
<h2 data-anchor-id="developing-an-interim-primary-productivity-product">
Additional Resources
</h2>
<details>
<summary style="font-weight: bold; font-size: 1.2em; margin-bottom: 5px; color: #0072ce;">
References
</summary>
<ul>
<li>
<a href="https://aslopubs.onlinelibrary.wiley.com/doi/10.4319/lo.1997.42.1.0001">Behrenfeld and Falkowski. (1997) Photosynthetic rates derived from satellite-based chlorophyll concentration Limnol. Oceanogr. . 42:1-20.</a>
</li>
</ul>
</details>
<details>
<summary style="font-weight: bold; font-size: 1.2em; margin-bottom: 5px; color: #0072ce;">
Project Team and Funding
</summary>
<ul>
<p>
The project team included: Dale Robinson, Cara Wilson, Sunny Hospital, Veronica Lance, Johnathon Sherman, Kim Hyde, Andrea VanderWoude, Kari Stlaurent, Melanie Abecassis, Ryan Rykaczewski, Ryan Vandermeulen, and Menghua Wang.
</p>
<p>
A special thanks to Jesse Espinoza and Madison Richardson who made important contributions to the project including helping to generate the production Python code to produce the netPP products.
</p>
<p>
The project was supported by funding from the Portfolio Management Branch of NESDIS, NOAA CoastWatch, and CSU COAST.
</p>
</ul>
</details>
<hr>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<h1>
Primary Productivity (netPP) Algorithm
</h1>
<p>
The Behrenfeld and Falkowski (1997) algorithm estimates primary productivity using satellite measurements and derived parameters. The algorithm formulation is listed below:
</p>
<blockquote class="blockquote">
<p style="color: black;">
<span class="math inline">\(netPP = 0.66125 \times P_{opt}^b \times \frac{PAR^o}{PAR^o + 4.1} \times Z_{eu} \times CHL \times DL\)</span>
</p>
</blockquote>
<h3>
Satellite Measurements
</h3>
<p>
The algorithm uses three satellite measurements:
</p>
<ul>
<li>
<strong>CHL</strong> - Surface Chlorophyll_a Concentration
</li>
<li>
<strong>PAR</strong> - Photosynthetically Active Radiation
</li>
<li>
<strong>Sea Surface Temperature</strong>
</li>
</ul>
<h3>
Derived Parameters
</h3>
<p>
The derived parameters are:
</p>
<ul>
<li>
<strong><span class="math inline">\(P_{opt}^b\)</span></strong> - Maximum Carbon fixation rate within the water column - Units: <span class="math inline">\(mg\)</span> <span class="math inline">\(C\)</span> <span class="math inline">\(mg^{-2}\)</span> <span class="math inline">\(chl\)</span> <span class="math inline">\(h^{-1}\)</span> :
<blockquote style="margin: 0; padding-left: 1em; border-left: 4px solid #ddd;" class="blockquote">
<p style="color: black; margin: 0;">
<span class="math inline">\(P_{opt}^b = - 3.27E-8 \cdot SST^7 + 3.4132E-6 \cdot SST^6\)</span>
</p>
<p style="color: black; margin: 0;">
<span class="math inline">\(- 1.348E-4 \cdot SST^5 + 2.462E-3 \cdot SST^4\)</span>
</p>
<p style="color: black; margin: 0;">
<span class="math inline">\(- 0.0205 \cdot SST^3 + 0.0617 \cdot SST^2 + 0.2749 \cdot SST\)</span>
</p>
</blockquote>
<p>
</p>
</li><li>
<strong><span class="math inline">\(PAR/(PAR + 4.1)\)</span></strong> - Fraction of realized <span class="math inline">\(P_{opt}^b\)</span>
</li>
<p>
</p>
<li>
<strong><span class="math inline">\(Z_{eu}\)</span></strong> - Depth where light is 1% of that at the surface - Units: meters (m)
<p>
</p>
<p>
<span class="math inline">\(Z_{eu}\)</span> is derived from an estimate of the total chlorophyll concentration within the euphotic layer (<span><span class="math inline">\(CHL_{eu}\)</span></span>) based on the Case I models of Morel and Berthon (1989):
</p>
<blockquote class="blockquote">
<p style="color: black;">
<span class="math inline">\(Z_{eu} = 568.2 \cdot CHL^{-0.746} \quad \text{when } CHL_{eu} &gt; 10.0\)</span>
</p>
<p>
or
</p>
<p style="color: black;">
<span class="math inline">\(Z_{eu} = 200.0 \cdot CHL^{-0.293} \quad \text{when } CHL_{eu} \leq 10.0\)</span>
</p>
</blockquote>
<p>
Where:
</p>
<ul>
<blockquote class="blockquote">
<p style="color: black;">
<span class="math inline">\(CHL_{eu} = 38.0 \cdot CHL^{0.4250} \quad \text{when } CHL \leq 1.0\)</span>
</p>
<p>
or
</p>
<p style="color: black;">
<span class="math inline">\(CHL_{eu} = 40.2 \cdot CHL^{0.5070} \quad \text{when } CHL &gt; 1.0\)</span>
</p>
</blockquote>
</ul>
</li>
<li>
<strong>DL</strong> - Daylength determined from the day of the year and latitude - Units: hours
</li>
</ul>
<h2>
Satellite Data Used in the Algorithm
</h2>
<h4>
<strong>Legacy Product</strong>
</h4>
<p>
The original netPP product made by CoastWatch West Coast Node uses chlorophyll, sea surface temperature and photosynthetically active radiation derived from the MODIS sensor on the Aqua satellite. The dataset begins in 2002 and ends in 2024, offering daily, weekly, and monthly versions of the dataset.
</p>
<h4>
<strong>VIIRS SNPP Interim Product</strong>
</h4>
<p>
The VIIRS SNPP interim netPP product uses chlorophyll, sea surface temperature and photosynthetically active radiation derived from the VIIRS sensor on the SNPP satellite. The dataset begins in 2012 and continues to the present, offering daily, weekly, and monthly versions of the dataset.
</p>
<h4>
<strong>VIIRS NOAA20 Interim Product</strong>
</h4>
<p>
The VIIRS NOAA20 interim netPP product uses chlorophyll, sea surface temperature and photosynthetically active radiation derived from the VIIRS sensor on the NOAA20 satellite. The dataset begins in 2018 and continues to the present, offering daily, weekly, and monthly versions of the dataset.
</p>
<details>
<summary style="font-weight: bold; font-size: 1.5em; margin-bottom: 5px; color: #0072ce;">
Satellite Data Sources
</summary>
<ul>
<li>
<a>MODIS Aqua netPP</a>
</li>
<ul>
<li>
<a href="https://example.com">MODIS netPP</a>
</li>
</ul>
<li>
<a>MODIS Aqua input data for legacy nPP</a>
</li>
<ul>
<li>
<a href="https://example.com">MODIS Chlorophyll_a</a>
</li>
<li>
<a href="https://example.com">MODIS PAR</a>
</li>
<li>
<a href="https://example.com">MODIS SST</a>
</li>
</ul>
<li>
<a>VIIRS SNPP netPP</a>
</li>
<ul>
<li>
<a href="https://example.com">VIIRS SNPP netPP</a>
</li>
</ul>
<li>
<a>VIIRS SNPP input data for interim netPP</a>
</li>
<ul>
<li>
<a href="https://example.com">VIIRS SNPP Chlorophyll_a</a>
</li>
<li>
<a href="https://example.com">VIIRS SNPP PAR</a>
</li>
<li>
<a href="https://example.com">VIIRS SNPP SST</a>
</li>
</ul>
<li>
<a>VIIRS NOAA20 nPP</a>
</li>
<ul>
<li>
<a href="https://example.com">VIIRS NOAA20 netPP</a>
</li>
</ul>
<li>
<a>VIIRS NOAA20 input data for interim netPP</a>
</li>
<ul>
<li>
<a href="https://example.com">VIIRS NOAA20 Chlorophyll_a</a>
</li>
<li>
<a href="https://example.com">VIIRS NOAA20 PAR</a>
</li>
<li>
<a href="https://example.com">VIIRS NOAA20 SST</a>
</li>
</ul>
</ul>
</details>
<hr>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<h2>
Unbiased Relative Difference (ψ)
</h2>
<p>
We calculated the unbiased relative difference (ψ<sup>netPP</sup>) of the interim VIIRS netPP (netPP<sub>VIIRS</sub>) and legacy MODIS netPP (netPP<sub>MODIS</sub>) products to track the similarities in netPP values between interim VIIRS and legacy MODIS datasets. This provides validation that the interim netPP products can be reliably used for continuity in long-term productivity analyses.
</p>
<p>
We created the pixel-by-pixel unbiased relative difference (ψ<sup>netPP</sup>) for the globe for each month at 9km resolution across two datasets:
</p>
<p><a href="https://coastwatch.pfeg.noaa.gov/wcn/erddap/griddap/netpp_psi_snpp_modis.graph" target="_blank" style="text-decoration: none; color: #0072ce;"><strong>Unbiased Relative Difference, VIIRS-SNPP - MODIS-Aqua Global, Monthly, 9km, 2013-2022</strong></a></p>
<p><a href="https://coastwatch.pfeg.noaa.gov/wcn/erddap/griddap/netpp_psi_noaa20_modis.graph" target="_blank" style="text-decoration: none; color: #0072ce;"><strong>Unbiased Relative Difference, VIIRS-NOAA20 - MODIS-Aqua Global, Monthly, 9km, 2018-2022</strong></a></p>
<p>
The unbiased relative difference (ψ<sup>netPP</sup>) is calculated for each pixel as follows:
</p>
<blockquote class="blockquote">
<p style="text-align: left; color: black;  font-size: 1.5em;">
<span class="math inline">\(ψ^{netPP} = \frac{netPP_{VIIRS} - netPP_{MODIS}}{\left(\frac{netPP_{VIIRS} + netPP_{MODIS}}{2}\right)}\)</span>
</p>
</blockquote>
<p>
Where:
</p>
<ul>
<li>
The difference between VIIRS-based netPP (<i>netPP<sub>VIIRS</sub></i>) and MODIS-based netPP (<i>netPP<sub>MODIS</sub></i>) values for that pixel is divided by the mean of <i>netPP<sub>VIIRS</sub></i> and <i>netPP<sub>MODIS</sub></i>.
</li>
</ul>
<h2>
Absolute Relative Difference (Δ<sub>rel</sub>)
</h2>
<p>
We calculated the mean absolute relative difference (Δ<sub>rel</sub>) of the interim VIIRS netPP product (netPP<sub>VIIRS</sub>) and legacy MODIS netPP product (netPP<sub>MODIS</sub>).
</p>
<p>
We created the pixel-by-pixel mean absolute difference (Δ<sub>rel</sub>) for the globe for each month at 9km resolution across two datasets:
</p>
<p><a href="https://coastwatch.pfeg.noaa.gov/wcn/erddap/griddap/netpp_delta_snpp_modis.graph" target="_blank" style="text-decoration: none; color: #0072ce;"><strong>Absolute Relative Difference, VIIRS-SNPP - MODIS-Aqua Global, Monthly, 9km, 2013-2022</strong></a></p>
<p><a href="https://coastwatch.pfeg.noaa.gov/wcn/erddap/griddap/netpp_psi_noaa20_modis.graph" target="_blank" style="text-decoration: none; color: #0072ce;"><strong>Absolute Relative Difference, VIIRS-NOAA20 - MODIS-Aqua Global, Monthly, 9km, 2018-2022</strong></a></p>
<p>
The absolute relative difference (Δ<sup>netPP</sup>) is calculated for each pixel as follows:
</p>
<blockquote class="blockquote">
<p style="text-align: left; color: black; font-size: 1.5em;">
<span class="math inline">\(\Delta^{netPP} = \frac{netPP_{VIIRS} - netPP_{MODIS}}{netPP_{MODIS}}\)</span>
</p>
</blockquote>
<p>
Where:
</p>
<ul>
<li>
The difference between VIIRS-based netPP (<i>netPP<sub>VIIRS</sub></i>) and MODIS-based netPP (<i>netPP<sub>MODIS</sub></i>) values for that pixel is divided by <i>netPP<sub>MODIS</sub></i>.
</li>
</ul>
<h2>
Correlations
</h2>
<p>
The purpose of calculating Pearson’s correlation coefficient is to assess the agreement and disagreement across time and space between the MODIS and VIIRS datasets. Raw data and anomalies were used to calculate the correlation coefficents. Calculating the correlation coefficients with raw data enables us to evaluate the absolute agreement in primary productivity estimates, whereas calculating with anomalies enables us to focus on trends by removing seasonality. We also calculated p-values to test the statistical significance of the Pearson correlation coefficient for each pixel.
</p>
<p>
We calculated Pearson’s correlation coefficient for each pixel over the time dimension for each of these datasets:
</p>
<p><a href="http://localhost:8080/erddap/griddap/productivity_modis_aqua_monthly.graph" target="_blank" style="text-decoration: none; color: #0072ce;"><strong>Primary Productivity, MODIS-AQUA, Science Quality, Global, 9km, 2013-2022 (Monthly Composite)</strong></a></p>
<p><a href="http://localhost:8080/erddap/griddap/productivity_viirs_snpp_monthly.graph" target="_blank" style="text-decoration: none; color: #0072ce;"><strong>Primary Productivity, VIIRS-SNPP, Science Quality, Global, 9km, 2013-2022 (Monthly Composite)</strong></a></p>
<p><a href="http://localhost:8080/erddap/griddap/productivity_viirs_noaa20_monthly.graph" target="_blank" style="text-decoration: none; color: #0072ce;"><strong>Primary Productivity, VIIRS-NOAA20, Science Quality, Global, 9km, 2018-2022 (Monthly Composite)</strong></a></p>
<p>
The Pearson’s correlation coefficent is calculated for each pixel over all time steps for raw data as follows:
</p>
<blockquote class="blockquote">
<p style="text-align: left; color: black; font-size: 1.25em;">
<span class="math display">\[
  r_{i,j} = \frac{\sum_{t=1}^N (X_{t,i,j} - \bar{X}_{i,j})(Y_{t,i,j} - \bar{Y}_{i,j})}{\sqrt{\sum_{t=1}^N (X_{t,i,j} - \bar{X}_{i,j})^2 \cdot \sum_{t=1}^N (Y_{t,i,j} - \bar{Y}_{i,j})^2}}
  \]</span>
</p>
</blockquote>
<p>
Where:
</p>
<ul style="margin-top: 20px; margin-bottom: 20px;">
<li style="margin-bottom: 15px;">
<strong><i>r<sub> i , j </sub></i></strong>: Pearson correlation coefficient for the pixel <strong><i>(i, j)</i></strong>.
</li>
<li style="margin-bottom: 15px;">
<strong><i>X<sub> t, i, j </sub></i></strong>: Value from dataset <strong><i>X</i></strong> (MODIS) at time <strong><i>t</i></strong> for pixel <strong><i>(i, j)</i></strong>.
</li>
<li style="margin-bottom: 15px;">
<strong><i>Y<sub> t, i, j </sub></i></strong>: Value from dataset <strong><i>Y</i></strong> (VIIRS) at time <strong><i>t</i></strong> for pixel <strong><i>(i, j)</i></strong>.
</li>
<li style="margin-bottom: 15px;">
<strong><i>X̄<sub> i, j </sub></i></strong>: Mean of <strong><i>X<sub> t, i, j </sub></i></strong> over all <strong><i>t</i></strong> for pixel <strong><i>(i, j)</i></strong>.
</li>
<li style="margin-bottom: 15px;">
<strong><i>Ȳ<sub> i, j&nbsp;</sub></i></strong>: Mean of <strong><i>Y<sub> t, i, j </sub></i></strong> over all <strong><i>t</i></strong> for pixel <strong><i>(i, j)</i></strong>.
</li>
<li>
<strong><i>N</i></strong>: Number of time points (number of months).
</li>
</ul>
<p>
The Pearson’s correlation coefficent is calculated for each pixel over all time steps for anomalies as follows:
</p>
<blockquote class="blockquote">
<p style="text-align: left; color: black; font-size: 1.25em;">
<span class="math display">\[
  r_{i,j} = \frac{\sum_{t=1}^N \left(X'_{t,i,j} \cdot Y'_{t,i,j}\right)}{\sqrt{\sum_{t=1}^N \left(X'_{t,i,j}\right)^2 \cdot \sum_{t=1}^N \left(Y'_{t,i,j}\right)^2}}
  \]</span>
</p>
</blockquote>
<p>
Where:
</p>
<ul style="margin-top: 20px; margin-bottom: 20px;">
<li style="margin-bottom: 15px;">
<strong><i>r<sub> i , j </sub></i></strong>: Pearson correlation coefficient for the pixel <strong><i>(i, j)</i></strong>.
</li>
<li style="margin-bottom: 15px;">
<strong><i>X’<sub> t, i, j </sub></i></strong>: Anomaly of dataset <strong><i>X</i></strong> (MODIS) at time <strong><i>t</i></strong> for pixel <strong><i>(i, j)</i></strong> calculated as:
<ul style="margin-bottom: 20px; color: #005b96; text-align: left;">
<strong><i>X’<sub> t, i, j </sub></i></strong> = <strong><i>X <sub> t, i, j </sub></i></strong> - Climatology<sub>X</sub>(<strong><i> i, j </i></strong> month(<strong><i>t</i></strong>))
</ul>
</li><li style="margin-bottom: 15px;">
<strong><i>Y’<sub> t, i, j </sub></i></strong>: Anomaly of dataset <strong><i>Y</i></strong> (VIIRS) at time <strong><i>t</i></strong> for pixel <strong><i>(i, j)</i></strong> calculated as:
<ul style="margin-bottom: 20px; color: #005b96; text-align: left;">
<strong><i>Y’<sub> t, i, j </sub></i></strong> = <strong><i>Y<sub> t, i, j </sub></i></strong> - Climatology<sub>Y</sub>(<strong><i> i, j </i></strong> month(<strong><i>t</i></strong>))
</ul>
</li>
<li>
<strong><i>N</i></strong>: Number of time points (number of months).
</li>
</ul>
<h2>
Trends
</h2>
<p>
The purpose of calculating linear trends for each of the datasets is to evaluate how much the products agree or disagree over time and across regions. We calculated linear trends in the time series of monthly primary productivity for each pixel with either raw data or anomalies for the MODIS-Aqua, VIIRS-SNPP, and VIIRS-NOAA20 datasets. Finding trends using raw data allows us to anaylze the absolute agreement in primary productivity estimates between the datasets, whereas calculating with anomalies enables us to focus on trends by removing seasonality. We calculated p-values to test the statistical significance of the trends for each pixel.
</p>
<p>
The linear trend is calculated for each pixel over all time steps for raw data as follows:
</p>
<p>
The linear trend is calculated for each pixel over all time steps for anomalies as follows:
</p>
<h2>
Contingency Matrix
</h2>
<p>
A contingency matrix helps assess the similarities and differences between the legacy and interim products. Using the linear trends we calculated above, we constructed a contingency matrix to compare the trends between the legacy and interim primary productivity products. Pixels were categorized by the matrix into three groups based on the sign of the slope.
</p>
<ul>
<li>
<strong>Postive trend</strong>: Increasing trend (positive slope).
</li>
<li>
<strong>Negative trend</strong>: Decreasing trend (negative slope).
</li>
<li>
<strong>No significant trend</strong>: Slope not significantly different from zero.
</li>
</ul>
<p>The contingency matrix shows the percentage of pixels where the legacy and interim primary productivity products agree or disagree. The diagonal cells descending from left to right show where the products agree, and the off-diagonal cells show where the products disagree.</p>
<p>The contingency matrix is used to compute Cohen’s Kappa, a statistical measure that quantifies the level of agreement between the two NetPP products. Cohen’s Kappa accounts for the agreement occuring by chance and provides a standardized metric of similarity. The scale ranges from 0 (no agreement) to 1 (perfect agreement).</p>
<hr>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<h2>
Code Gallery
</h2>
<h2>
Satellite Courses
</h2>
<p>
CoastWatch hosts satellite training opportunites in-person and online, providing users with the knowledge and skills to utilize satellite data in their research.
</p>
<p><a href="https://coastwatch.pfeg.noaa.gov/courses/satellite_course.html" target="_blank" style="text-decoration: none;"> <button style="padding: 10px 20px; font-size: 18px; color:white; background-color:  #0072ce; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;"> Satellite Courses<span style="margin-left: 10px;">→</span> </button> </a></p>
<h2>
ERDDAP Server
</h2>
<p>
Search satellite data on the CoastWatch West Coast Node ERDDAP data server.
</p>
<p><a href="https://coastwatch.pfeg.noaa.gov/erddap/index.html" target="_blank" style="text-decoration: none;"> <button style="padding: 10px 20px; font-size: 18px; color:white; background-color:  #0072ce; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;"> ERDDAP<span style="margin-left: 10px;">→</span> </button> </a></p>
<hr>


</div>
</div>
</div>
</section>

</main> <!-- /main -->
<div style="text-align: center; padding: 20px; border-top: 1px solid #ddd;">
    <img src="images/DeptCommerce.png" alt="Logo 1" style="height: 70px; margin-right: 20px;">
    <img src="images/CoastWatchLogo.png" alt="Logo 2" style="height: 70px;">
  </div>
  
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>