[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Developing an Interim Primary Productivity Product",
    "section": "",
    "text": "Developing an Interim Primary Productivity Product\n\n Primary Productivity\n\n\nNetPP ProductAlgorithm and DataStatistical AnalysisUser Resources\n\n\n\nWhy do we need an interim product?\n\n\nThe only available primary productivity satellite product from NOAA was developed by the CoastWatch West Coast Node in 2007. The product is based on the Vertically Generalized Production Model (VPGM) described by Behrenfeld and Falkowski (1997) utilizing data from the MODIS sensor on the Aqua satellite.\n\n\nHowever, the MODIS Aqua sensor will be decommissioned soon. While new primary productivity algorithms that use the latest satellite sensors are under development, they are unlikely to be in production before MODIS Aqua is retired. Therefore, an interim product is required to address the needs of users for primary productivity data during the gap between the loss of the legacy MODIS primary productivity and the availablity of the new generation primary productivity products.\n\n\nTwo interim primary productivity products, VIIRS SNPP and VIIRS NOAA20, are now available. Details on how these products were developed, can be found under the Algorithm and Data tab.\n\n\n\n\nBoth interim products have undergone comprehensive statistical evaluation to ensure accuracy and reliability. The methods that were used to do so are found under the Statistical Analysis tab.\n\n\n\n\nFor users interested in conducting their own statistical analyses tailored to their region of interest will find Python notebooks in the User Resources tab that provide step-by-step guidance.\n\n\nAdditional Resources\n\n\n\nReferences\n\n\n\nBehrenfeld and Falkowski. (1997) Photosynthetic rates derived from satellite-based chlorophyll concentration Limnol. Oceanogr. . 42:1-20.\n\n\n\n\n\nProject Team and Funding\n\n\n\nThe project team included: Dale Robinson, Cara Wilson, Sunny Hospital, Veronica Lance, Johnathon Sherman, Kim Hyde, Andrea VanderWoude, Kari Stlaurent, Melanie Abecassis, Ryan Rykaczewski, Ryan Vandermeulen, and Menghua Wang.\n\n\nA special thanks to Jesse Espinoza and Madison Richardson who made important contributions to the project including helping to generate the production Python code to produce the netPP products.\n\n\nThe project was supported by funding from the Portfolio Management Branch of NESDIS, NOAA CoastWatch, and CSU COAST.\n\n\n\n\n\n\n\nPrimary Productivity (netPP) Algorithm\n\n\nThe Behrenfeld and Falkowski (1997) algorithm estimates primary productivity using satellite measurements and derived parameters. The algorithm formulation is listed below:\n\n\n\n\\(netPP = 0.66125 \\times P_{opt}^b \\times \\frac{PAR^o}{PAR^o + 4.1} \\times Z_{eu} \\times CHL \\times DL\\)\n\n\n\nSatellite Measurements\n\n\nThe algorithm uses three satellite measurements:\n\n\n\nCHL - Surface Chlorophyll_a Concentration\n\n\nPAR - Photosynthetically Active Radiation\n\n\nSea Surface Temperature\n\n\n\nDerived Parameters\n\n\nThe derived parameters are:\n\n\n\n\\(P_{opt}^b\\) - Maximum Carbon fixation rate within the water column - Units: \\(mg\\) \\(C\\) \\(mg^{-2}\\) \\(chl\\) \\(h^{-1}\\) :\n\n\n\\(P_{opt}^b = - 3.27E-8 \\cdot SST^7 + 3.4132E-6 \\cdot SST^6\\)\n\n\n\\(- 1.348E-4 \\cdot SST^5 + 2.462E-3 \\cdot SST^4\\)\n\n\n\\(- 0.0205 \\cdot SST^3 + 0.0617 \\cdot SST^2 + 0.2749 \\cdot SST\\)\n\n\n\n\n\n\\(PAR/(PAR + 4.1)\\) - Fraction of realized \\(P_{opt}^b\\)\n\n\n\n\n\\(Z_{eu}\\) - Depth where light is 1% of that at the surface - Units: meters (m)\n\n\n\n\\(Z_{eu}\\) is derived from an estimate of the total chlorophyll concentration within the euphotic layer (\\(CHL_{eu}\\)) based on the Case I models of Morel and Berthon (1989):\n\n\n\n\\(Z_{eu} = 568.2 \\cdot CHL^{-0.746} \\quad \\text{when } CHL_{eu} &gt; 10.0\\)\n\n\nor\n\n\n\\(Z_{eu} = 200.0 \\cdot CHL^{-0.293} \\quad \\text{when } CHL_{eu} \\leq 10.0\\)\n\n\n\nWhere:\n\n\n\n\n\\(CHL_{eu} = 38.0 \\cdot CHL^{0.4250} \\quad \\text{when } CHL \\leq 1.0\\)\n\n\nor\n\n\n\\(CHL_{eu} = 40.2 \\cdot CHL^{0.5070} \\quad \\text{when } CHL &gt; 1.0\\)\n\n\n\n\n\nDL - Daylength determined from the day of the year and latitude - Units: hours\n\n\n\nSatellite Data Used in the Algorithm\n\n\nLegacy Product\n\n\nThe original netPP product made by CoastWatch West Coast Node uses chlorophyll, sea surface temperature and photosynthetically active radiation derived from the MODIS sensor on the Aqua satellite. The dataset begins in 2002 and ends in 2024, offering daily, weekly, and monthly versions of the dataset.\n\n\nVIIRS SNPP Interim Product\n\n\nThe VIIRS SNPP interim netPP product uses chlorophyll, sea surface temperature and photosynthetically active radiation derived from the VIIRS sensor on the SNPP satellite. The dataset begins in 2012 and continues to the present, offering daily, weekly, and monthly versions of the dataset.\n\n\nVIIRS NOAA20 Interim Product\n\n\nThe VIIRS NOAA20 interim netPP product uses chlorophyll, sea surface temperature and photosynthetically active radiation derived from the VIIRS sensor on the NOAA20 satellite. The dataset begins in 2018 and continues to the present, offering daily, weekly, and monthly versions of the dataset.\n\n\n\nSatellite Data Sources\n\n\n\nMODIS Aqua netPP\n\n\n\nMODIS netPP\n\n\n\nMODIS Aqua input data for legacy nPP\n\n\n\nMODIS Chlorophyll_a\n\n\nMODIS PAR\n\n\nMODIS SST\n\n\n\nVIIRS SNPP netPP\n\n\n\nVIIRS SNPP netPP\n\n\n\nVIIRS SNPP input data for interim netPP\n\n\n\nVIIRS SNPP Chlorophyll_a\n\n\nVIIRS SNPP PAR\n\n\nVIIRS SNPP SST\n\n\n\nVIIRS NOAA20 nPP\n\n\n\nVIIRS NOAA20 netPP\n\n\n\nVIIRS NOAA20 input data for interim netPP\n\n\n\nVIIRS NOAA20 Chlorophyll_a\n\n\nVIIRS NOAA20 PAR\n\n\nVIIRS NOAA20 SST\n\n\n\n\n\n\n\n\nUnbiased Relative Difference (ψ)\n\n\nWe calculated the unbiased relative difference (ψnetPP) of the interim VIIRS netPP (netPPVIIRS) and legacy MODIS netPP (netPPMODIS) products to track the similarities in netPP values between interim VIIRS and legacy MODIS datasets. This provides validation that the interim netPP products can be reliably used for continuity in long-term productivity analyses.\n\n\nWe created the pixel-by-pixel unbiased relative difference (ψnetPP) for the globe for each month at 9km resolution across two datasets:\n\nUnbiased Relative Difference, VIIRS-SNPP - MODIS-Aqua Global, Monthly, 9km, 2013-2022\nUnbiased Relative Difference, VIIRS-NOAA20 - MODIS-Aqua Global, Monthly, 9km, 2018-2022\n\nThe unbiased relative difference (ψnetPP) is calculated for each pixel as follows:\n\n\n\n\\(ψ^{netPP} = \\frac{netPP_{VIIRS} - netPP_{MODIS}}{\\left(\\frac{netPP_{VIIRS} + netPP_{MODIS}}{2}\\right)}\\)\n\n\n\nWhere:\n\n\n\nThe difference between VIIRS-based netPP (netPPVIIRS) and MODIS-based netPP (netPPMODIS) values for that pixel is divided by the mean of netPPVIIRS and netPPMODIS.\n\n\n\nAbsolute Relative Difference (Δrel)\n\n\nWe calculated the mean absolute relative difference (Δrel) of the interim VIIRS netPP product (netPPVIIRS) and legacy MODIS netPP product (netPPMODIS).\n\n\nWe created the pixel-by-pixel mean absolute difference (Δrel) for the globe for each month at 9km resolution across two datasets:\n\nAbsolute Relative Difference, VIIRS-SNPP - MODIS-Aqua Global, Monthly, 9km, 2013-2022\nAbsolute Relative Difference, VIIRS-NOAA20 - MODIS-Aqua Global, Monthly, 9km, 2018-2022\n\nThe absolute relative difference (ΔnetPP) is calculated for each pixel as follows:\n\n\n\n\\(\\Delta^{netPP} = \\frac{netPP_{VIIRS} - netPP_{MODIS}}{netPP_{MODIS}}\\)\n\n\n\nWhere:\n\n\n\nThe difference between VIIRS-based netPP (netPPVIIRS) and MODIS-based netPP (netPPMODIS) values for that pixel is divided by netPPMODIS.\n\n\n\nCorrelations\n\n\nThe purpose of calculating Pearson’s correlation coefficient is to assess the agreement and disagreement across time and space between the MODIS and VIIRS datasets. Raw data and anomalies were used to calculate the correlation coefficents. Calculating the correlation coefficients with raw data enables us to evaluate the absolute agreement in primary productivity estimates, whereas calculating with anomalies enables us to focus on trends by removing seasonality. We also calculated p-values to test the statistical significance of the Pearson correlation coefficient for each pixel.\n\n\nWe calculated Pearson’s correlation coefficient for each pixel over the time dimension for each of these datasets:\n\nPrimary Productivity, MODIS-AQUA, Science Quality, Global, 9km, 2013-2022 (Monthly Composite)\nPrimary Productivity, VIIRS-SNPP, Science Quality, Global, 9km, 2013-2022 (Monthly Composite)\nPrimary Productivity, VIIRS-NOAA20, Science Quality, Global, 9km, 2018-2022 (Monthly Composite)\n\nThe Pearson’s correlation coefficent is calculated for each pixel over all time steps for raw data as follows:\n\n\n\n\\[\n  r_{i,j} = \\frac{\\sum_{t=1}^N (X_{t,i,j} - \\bar{X}_{i,j})(Y_{t,i,j} - \\bar{Y}_{i,j})}{\\sqrt{\\sum_{t=1}^N (X_{t,i,j} - \\bar{X}_{i,j})^2 \\cdot \\sum_{t=1}^N (Y_{t,i,j} - \\bar{Y}_{i,j})^2}}\n  \\]\n\n\n\nWhere:\n\n\n\nr i , j : Pearson correlation coefficient for the pixel (i, j).\n\n\nX t, i, j : Value from dataset X (MODIS) at time t for pixel (i, j).\n\n\nY t, i, j : Value from dataset Y (VIIRS) at time t for pixel (i, j).\n\n\nX̄ i, j : Mean of X t, i, j  over all t for pixel (i, j).\n\n\nȲ i, j : Mean of Y t, i, j  over all t for pixel (i, j).\n\n\nN: Number of time points (number of months).\n\n\n\nThe Pearson’s correlation coefficent is calculated for each pixel over all time steps for anomalies as follows:\n\n\n\n\\[\n  r_{i,j} = \\frac{\\sum_{t=1}^N \\left(X'_{t,i,j} \\cdot Y'_{t,i,j}\\right)}{\\sqrt{\\sum_{t=1}^N \\left(X'_{t,i,j}\\right)^2 \\cdot \\sum_{t=1}^N \\left(Y'_{t,i,j}\\right)^2}}\n  \\]\n\n\n\nWhere:\n\n\n\nr i , j : Pearson correlation coefficient for the pixel (i, j).\n\n\nX’ t, i, j : Anomaly of dataset X (MODIS) at time t for pixel (i, j) calculated as:\n\nX’ t, i, j  = X  t, i, j  - ClimatologyX( i, j  month(t))\n\n\nY’ t, i, j : Anomaly of dataset Y (VIIRS) at time t for pixel (i, j) calculated as:\n\nY’ t, i, j  = Y t, i, j  - ClimatologyY( i, j  month(t))\n\n\n\nN: Number of time points (number of months).\n\n\n\nTrends\n\n\nThe purpose of calculating linear trends for each of the datasets is to evaluate how much the products agree or disagree over time and across regions. We calculated linear trends in the time series of monthly primary productivity for each pixel with either raw data or anomalies for the MODIS-Aqua, VIIRS-SNPP, and VIIRS-NOAA20 datasets. Finding trends using raw data allows us to anaylze the absolute agreement in primary productivity estimates between the datasets, whereas calculating with anomalies enables us to focus on trends by removing seasonality. We calculated p-values to test the statistical significance of the trends for each pixel.\n\n\nThe linear trend is calculated for each pixel over all time steps for raw data as follows:\n\n\nThe linear trend is calculated for each pixel over all time steps for anomalies as follows:\n\n\nContingency Matrix\n\n\nA contingency matrix helps assess the similarities and differences between the legacy and interim products. Using the linear trends we calculated above, we constructed a contingency matrix to compare the trends between the legacy and interim primary productivity products. Pixels were categorized by the matrix into three groups based on the sign of the slope.\n\n\n\nPostive trend: Increasing trend (positive slope).\n\n\nNegative trend: Decreasing trend (negative slope).\n\n\nNo significant trend: Slope not significantly different from zero.\n\n\nThe contingency matrix shows the percentage of pixels where the legacy and interim primary productivity products agree or disagree. The diagonal cells descending from left to right show where the products agree, and the off-diagonal cells show where the products disagree.\nThe contingency matrix is used to compute Cohen’s Kappa, a statistical measure that quantifies the level of agreement between the two NetPP products. Cohen’s Kappa accounts for the agreement occuring by chance and provides a standardized metric of similarity. The scale ranges from 0 (no agreement) to 1 (perfect agreement).\n\n\n\n\nCode Gallery\n\n\nSatellite Courses\n\n\nCoastWatch hosts satellite training opportunites in-person and online, providing users with the knowledge and skills to utilize satellite data in their research.\n\n  Satellite Courses→  \n\nERDDAP Server\n\n\nSearch satellite data on the CoastWatch West Coast Node ERDDAP data server.\n\n  ERDDAP→"
  }
]